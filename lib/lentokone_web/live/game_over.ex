defmodule LentokoneWeb.GameOverLive do
  use LentokoneWeb, :live_view

  def mount(params, _session, socket) do
    {:ok, assign(socket, score: params["score"])}
  end

  def render(assigns) do
    ~L"""
    <section class="phx-hero">
      <h2>Your score: <%= @score %></h2>
      <%= render_game_over(assigns) %>
      <button phx-click="play">Play again?</button>
    </section>
    """
  end

  defp render_game_over(assigns) do
    ~L"""
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 270.12 214.78">
      <defs><style>.cls-1,.cls-2,.cls-3,.cls-4,.cls-5,.cls-6,.cls-7{fill-rule:evenodd;}.cls-1{fill:url(#radial-gradient);}.cls-2{fill:#cb2900;}.cls-3{fill:url(#linear-gradient);}.cls-4{fill:url(#linear-gradient-2);}.cls-5{fill:#631818;}.cls-6{fill:#b1b1b1;}.cls-7{fill:#7c7c7c;}
      </style><radialGradient id="radial-gradient" cx="-253.48" cy="1917.1" r="40.22" gradientTransform="translate(991.91 -321.07) scale(3.38 0.27)"
      gradientUnits="userSpaceOnUse"><stop offset="0.67" stop-color="#cecece"/><stop offset="1" stop-color="#fff"/></radialGradient><linearGradient
      id="linear-gradient" x1="-796.68" y1="883.84" x2="-774.31" y2="922.59" gradientTransform="translate(651.62 -465.49) scale(0.67)"
      gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#cb2900"/><stop offset="1" stop-color="#900"/>
      </linearGradient><linearGradient id="linear-gradient-2" x1="-802.49" y1="979.61" x2="-757.63" y2="979.61" xlink:href="#linear-gradient"/>
      </defs><g id="Layer_2" data-name="Layer 2"><g id="Layer_1-2" data-name="Layer 1">
      <path class="cls-1" d="M135.06,192.9q56,0,95.45,3.2t39.61,7.74q0,4.53-39.61,7.73t-95.45,3.21q-55.95,0-95.57-3.21T0,203.84q0-4.54,39.49-7.74T135.06,192.9Z"/><path class="cls-2" d="M136.11,202.93a2.74,2.74,0,0,0,.57-1.26q.62-4.29-4-7.28a82.6,82.6,0,0,0-9.44-5.3A45.35,45.35,0,0,0,112,185.61l0,.06a20.56,20.56,0,0,0-3.25,4.38,16.05,16.05,0,0,0-2.15,7.95,17.56,17.56,0,0,0,.89,5.51l-3.82.37c-4.73.46-9.45.85-14.13,1.18q-7.29.62-14.6,1-7.77.41-15.47.46a102.16,102.16,0,0,1-10.9-.49A158.29,158.29,0,0,1,33,202.9a10,10,0,0,1-1.44-.56,29.21,29.21,0,0,1-9.77-7.9,17.67,17.67,0,0,1-3.52-16A46,46,0,0,1,24.82,163a102.35,102.35,0,0,1,10.1-13A155.1,155.1,0,0,1,46.08,139a166.86,166.86,0,0,1,13.06-10.59Q65,124.06,71,120.2q7-4.52,14.37-8.26Q91.13,109,97,106.43t11.82-4.93q6-2.28,12.16-4.13T133,94.29Q139,93,145,92q5.91-.86,11.88-1.31c3.92-.15,7.83-.23,11.75-.23a56.75,56.75,0,0,1,15.85,2.31l1.09.32q6.67,2,13.15,4.47a130.59,130.59,0,0,1,12.38,5.58l1.65.86a112.08,112.08,0,0,1,12.37,7.57,33.58,33.58,0,0,1,10.51,12.16,9.13,9.13,0,0,1,1,3.31q.72,7.59-4.62,12.28a68.62,68.62,0,0,1-13.31,9.37,40.76,40.76,0,0,0-3.58,2.14,44,44,0,0,0-5.35,4.22,11,11,0,0,0-2.95,4.62q-2.1,6.12,2.95,9.85,2.79,2.08,5.54,4.2c2.11,1.61,4.19,3.23,6.26,4.85a21.76,21.76,0,0,1,7,9.81c1.44,4,1.94,7.16,1.53,9.58s-1.14,4.09-2.17,5-5,1.67-12,2.29c-.85.07-2,.13-3.43.16q-7.23.17-24.36-.37Q168.58,204.46,136.11,202.93Zm-13-77.57-.74,0c-4.91.32-7.65.65-8.23,1q-2.56,1.5-5.31,6.52c-.83,1.76-1.48,3.1-1.93,4q3.75,2.41,10.67,11.36a76.94,76.94,0,0,0,5.16,6.08c1.81,1.74,3.37,2.62,4.67,2.62q3.66,0,3.67-9.55a24.73,24.73,0,0,0-1.93-8.41Q127,133.26,123.16,125.36Z"/>
      <path class="cls-3" d="M123.16,125.36q3.82,7.9,6,13.67a24.73,24.73,0,0,1,1.93,8.41q0,9.56-3.67,9.55c-1.3,0-2.86-.88-4.67-2.62a76.94,76.94,0,0,1-5.16-6.08q-6.91-8.94-10.67-11.36c.45-.93,1.1-2.27,1.93-4q2.75-5,5.31-6.52c.58-.32,3.32-.65,8.23-1Z"/>
      <path class="cls-4" d="M136.11,202.93q-1.47,2.37-23.21,0l-5.49.58a17.56,17.56,0,0,1-.89-5.51,16.05,16.05,0,0,1,2.15-7.95,20.56,20.56,0,0,1,3.25-4.38l0-.06a45.35,45.35,0,0,1,11.27,3.48,82.6,82.6,0,0,1,9.44,5.3q4.62,3,4,7.28A2.74,2.74,0,0,1,136.11,202.93Z"/>
      <polygon class="cls-5" points="73.72 158.18 78.25 163.19 76.19 164.84 71.27 160.38 66.3 164.87 64.66 162.81 68.84 158.19 64.2 153.99 66.88 150.6 71.29 155.49 75.5 150.84 78.89 153.5 73.72 158.18"/>
      <polygon class="cls-5" points="78.24 198.78 82.27 202.22 80.43 203.35 76.06 200.29 71.63 203.38 70.17 201.96 73.9 198.78 69.77 195.9 72.15 193.57 76.08 196.93 79.83 193.73 82.84 195.56 78.24 198.78"/>
      <path class="cls-5" d="M90.76,149.7l.87-1.47,10.43,7.21a.63.63,0,0,1,.28.36,1,1,0,0,1,0,.52.86.86,0,0,1-.25.44l-8.37,8,8.93,7.73a.72.72,0,0,1,.22.36.83.83,0,0,1,0,.44.76.76,0,0,1-.25.34l-7.82,6.5,6.66,5a.54.54,0,0,1,.23.33.55.55,0,0,1,0,.4.6.6,0,0,1-.24.34l-4.8,3.64,4.86,3.76a.6.6,0,0,1,.22.36.54.54,0,0,1,0,.18.72.72,0,0,1,0,.19.65.65,0,0,1-.29.32l-5.6,3.33-.74-1.05L99.86,194l-4.79-3.71a.58.58,0,0,1-.23-.31.51.51,0,0,1,0-.4.65.65,0,0,1,.24-.33l4.73-3.6-6.65-4.9a1,1,0,0,1-.24-.37.6.6,0,0,1,0-.42.62.62,0,0,1,.22-.35l7.85-6.54-8.92-7.68a.61.61,0,0,1-.25-.36.67.67,0,0,1,0-.44.72.72,0,0,1,.22-.37l8.27-8Z"/>
      <path class="cls-6" d="M210.51,14.8h22.23v7.42H210.51v7.42h29.65v7.42H195.67V0h44.49V7.42H210.51Zm-51.9,0H166V7.42h7.42V0h14.8V37.06h-14.8V22.22H166v7.42h-7.42V22.22h-7.42V37.06H136.38V0h14.81V7.42h7.42ZM77.06,7.42H47.42V29.64H62.26V22.22H54.84V14.8H77.06V37.06H40V29.64H32.58V7.42H40V0H77.06ZM91.9,0h29.64V7.42H129V37.06H114.12V22.22H99.32V37.06H84.48V7.42H91.9Zm7.42,14.8h14.8V7.42H99.32Z"/>
      <path class="cls-7" d="M43.69,44.62H73.34V52h7.42V74.28H73.34v7.41H43.69V74.28H36.28V52h7.41ZM51.1,52V74.28H65.93V52Zm37.07-7.42H103V59.45h14.82V44.62h14.83V59.45h-7.42V74.28h-7.41v7.41H103V74.28H95.58V59.45H88.17Zm66.72,14.83h22.24v7.41H154.89v7.42h29.65v7.41H140.06V44.62h44.48V52H154.89Zm51.89,7.41H221.6V52H206.78ZM236.43,52V66.86H229v7.42h7.41v7.41H214.19V74.28h-7.41v7.41H192V44.62H229V52Z"/>
    </g></g></svg>
    """
  end

  defp play(socket) do
    socket
    |> push_redirect(to: "/game")
  end

  def handle_event("play", _, socket) do
    {:noreply, socket |> play}
  end

end
